# 微信礼品卡实现
	本文介绍微信礼品卡的完整实现流程。微信礼品卡功能是微信结合公众号、小程序、卡包三者实现的在微信社交（分享、群发等）功能上使用礼品卡。

## 什么是礼品卡
礼品卡分为商品礼品卡、不可充值的现金卡、可充值的余额卡。

- 商品礼品卡即每张卡券对应了一个商品，用户拥有的每张礼品卡只能兑换唯一的一个商品。
- 不可充值现金卡即每张卡券有固定余额，用户可以将该卡券到对应商户购买指定或任意（由商家决定）商品。
- 可充值余额卡即每张卡券类似一张简易银行，他具有充值，消费的功能。

微信已实现的礼品卡例子可以参考：`i麦当劳`、`星巴克用星说` 等小程序

## 商户开发者要如何实现完整礼品卡业务
要知道商户开发者需要如何实现完整的礼品卡业务，首先需要了解微信在这个功能上实现了什么，以及提供了什么能力可以让商户开发者接入的。

**首先：**微信提供API供开发者配置一个或多个礼品卡货架、配置多个礼品卡类型、礼品卡加挂到到货架上、货架发布。

**其次：**商户开发者通过api调用微信接口实现了以上功能后，微信实现了用户可以通过微信支付购买礼品卡、可以将购买的礼品卡发送到微信群、或分享给用户（是否可以分享到微信群是在礼品卡类型中配置，具体见下面的礼品卡配置流程）、被分享者可以领取卡券、查看卡券。微信的这些功能都会以事件的形式通知商户开发者，商户开发者可以通过接收这些事件做相应的业务逻辑处理或数据分析。

**最后：**用户领到卡券后礼品卡会被加入到卡包，用户可以进入卡包使用，对于使用的功能需要由商户开发者实现，并将使用结果通知微信（*这里使用结果可以是将微信的商品礼品卡更新为已使用，也可以更新卡券的余额*）


## 实现礼品卡的流程


### 礼品卡配置
礼品卡的配置接口同微信卡券配置接口:[微信卡券接口](https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421141229)

### 礼品卡库存管理


### 礼品卡的生命周期

* 购买事件

	接口如下:	**//todo**

	用户购买成功后微信会推送一个购买成功事件，其字段含pageId（货架号）、orderId（商户订单号）。此时对于商户开发者来说并不知道用户购买了哪些商品以及哪些

	*特殊说明：微信礼品卡由商户单号和交易单号的区分，对于用户购买成功后在微信支付服务号的消息中默认看到的是交易单号（全数字组成），点击支付消息进去后可看到商户单号（由字母数字混合组成）*
* 领用事件
